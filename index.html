<!doctype html>
<html lang="ru">

<head>
	<meta charset="utf-8">

	<title>«Если у вас нету тестов ...»</title>

	<meta name="description" content="Про тестирование приложений на языке JavaScript">
	<meta name="author" content="Сергей Жигалов">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/night.css">
    <link rel="stylesheet" href="css/user.css">

	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
</head>

<body>

<div class="reveal">

	<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">
<section>
	<h3>«Если у вас нету тестов ...»</h3>

    <p>Сергей Жигалов</p>
    <p><img src="images/logo.svg" alt="Яндекс" style="background-color: #111111" /></p>
</section>

<!-- Мотивационная часть в которой я стараюсь объяснить зачем нужны тесты -->

<section>
    <section data-background="images/tests-is-pain.jpg" class='image'>
        <h3>Зачем?</h3>
    </section>

    <section>
        <h4>Много-много лет назад...</h4>

        <ul>
            <li class="fragment">Показать всплывашку</li>
            <li class="fragment">Подсветить инпут</li>
            <li class="fragment">Задизейблить кнопочку</li>
        </ul>
    </section>

    <section>
        <h4>Много-много лет назад...</h4>

        <img src="images/old_web_application.png" alt="Old web application" />
    </section>

    <section>
        <h4>... но сейчас</h4>

        <img src="images/new_web_application.png" alt="New web application" />
    </section>

    <section>
        <h4>Поддержка кода</h4>

        <ul>
            <li class="fragment">Рефакторинг</li>
            <li class="fragment">Обновление зависимостей</li>
            <li class="fragment">Целостность продукта при распределенной разработке</li>
            <li class="fragment">Живая документация</li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3>Багфикс через тесты</h3>

        <ol>
            <li class="fragment">По описанию бага пишем тест</li>
            <li class="fragment">Проверяем что баг воспроизводится</li>
            <li class="fragment">Чиним баг</li>
            <li class="fragment">Проверяем что бага нет</li>
        </ol>
    </section>

    <section>
        <h3>Багфикс через тесты</h3>

        <ul>
            <li class="fragment">Покрыли пропущеный кейс</li>
            <li class="fragment">Больше не словим этот баг</li>
            <li class="fragment">Легче чинить баг</li>
        </ul>
    </section>
</section>

<section>
    <section data-background="images/mother-child.jpeg" class='image'>
        <h3>как ребенок</h3>
    </section>
</section>

<section data-background="images/begin.jpg" class='image'>
    <h3>К делу!</h3>
</section>

<section>

    <section>
        <h3>Тестирование модулей</h3>
    </section>

    <section>
        <h3>Билдер хештегов</h3>

        <pre><code class="hljs javascript size-XS" data-trim>
'котаны'                    // '#Котаны'
'Живи быстро, умри молодым' // '#ЖивиБыстроУмриМолодым'
        </code></pre>
    </section>

    <section>
        <pre><code class="hljs javascript size-S" data-trim>
function hashTagGenerator(words) {
    return '#' + words
            .split(/\s+/)
            .map(normalizeWord)
            .join('');
}
        </code></pre>

        <pre class="fragment"><code class="hljs javascript size-S" data-trim>
function normalizeWord(word) {
    return word.charAt(0).toUpperCase() +
        word.toLowerCase().slice(1);
}
        </code></pre>

        <pre><code class="hljs javascript size-S fragment" data-trim>
module.exports = hashTagGenerator;
        </code></pre>
    </section>

    <section>
        <pre class="size-XS">app/
<span class="grey">└──</span> src
<span class="grey"> </span>   <span class="grey">└──</span> hashTagGenerator.js</span>
<span class="grey"> </span>   <span class="grey">└──</span> ...</span>
<span class="grey">└──</span> test
    <span class="grey">└──</span> hashTagGenerator-test.js</span>
    <span class="grey">└──</span> ...</span>
        </pre>
        <br />
        <pre class="fragment"><code class="hljs javascript size-XS" data-trim>
// hashTagGenerator-test.js
        </code></pre>

        <pre class="fragment"><code class="hljs javascript size-XS">
var hasTagGenerator = require('../src/hashTagGenerator');
require('chai').should();</code></pre>

        <pre class="fragment"><code class="hljs javascript size-XS">
describe('Hash tag generator', function () {
    /* test */
});</code></pre>
   </section>


    <section>
        <pre><code class="hljs javascript size-XS" data-trim>
it('should normalize words', function () {
    var actual = hasTagGenerator('hello DUMP');

    actual.should.be.equal('#HelloDump');
});
        </code></pre>
    </section>

    <section>
        <h3><a href="https://mochajs.org/">mocha</a></h3>

        <pre><code class="hljs size-S bash" data-trim>
$ npm install mocha --save-dev
        </code></pre>

        <pre><code class="hljs bash size-S fragment" data-trim>
$ mocha test
        </code></pre>
        <br>
        <pre class="size-S fragment" style="background-color: #3f3f3f">
  Hash tag generator
    <span style="color:green">✓</span> should start with #
    <span style="color:green">✓</span> should concat words
    <span style="color:green">✓</span> should normalize words

<span style="color:green">3 passing</span> (9ms)</pre>
    </section>

    <section data-background="images/thinking.jpg" class="image">
        <h2>... под другим углом</h2>
    </section>

    <section>
        <h3>И в какой-то момент</h3>

        <pre><code class="hljs javascript size-XS" data-trim>
it('should clean extra symbols', function () {
    var actual = hasTagGenerator('    #@my-ha-ha!!!');

    actual.should.be.equal('#MyHaHa');
});
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>Клиент-сайд тесты</h3>
    </section>

    <section data-background="images/twitter-signin.jpg" class='image'>
        <h4><a href="https://twitter.com/signup" target="_blank">DEMO</a></h4>
    </section>

    <section>
<pre class="javascript join-top fragment" data-fragment-index="1"><code class="size-XS">describe('Twitter signup', function () {</code></pre>
<pre class="javascript join-top fragment" data-fragment-index="2"><code class="size-XS">    it('should alert when enter `twitterok`', function () {</code></pre>
<pre class="javascript join-top fragment" data-fragment-index="3"><code class="size-XS">        $('#full-name').val('twitterok').trigger('input');</code></pre>
<pre class="javascript join-top fragment" data-fragment-index="3"><code class="size-XS"> </code></pre>
<pre class="javascript join-top fragment" data-fragment-index="3"><code class="size-XS">        $('.notwitter').hasClass('active').should.be.true;</code></pre>
<pre class="javascript join-top fragment" data-fragment-index="2"><code class="size-XS">    });</code></pre>
<pre class="javascript join-top fragment" data-fragment-index="1"><code class="size-XS">});</code></pre>
    </section>

    <section>
        <h4>&lt;head&gt;</h4>
        <pre><code class="hljs html size-XS" data-trim>
&lt;!-- подключаем стили Mocha --&gt;
&lt;link
    rel="stylesheet"
    href="./node_modules/mocha/mocha.css"&gt;
        </code></pre>
    </section>

    <section>
        <h4>&lt;body&gt;</h4>
        <pre><code class="hljs html size-XS" data-trim>
&lt;!-- подключаем библиотеки --&gt;
&lt;script src="./node_modules/mocha/mocha.js"&gt;&lt;/script&gt;
&lt;script src="./node_modules/chai/chai.js"&gt;&lt;/script&gt;
        </code></pre>

        <pre class="fragment"><code class="hljs html size-XS" data-trim>
&lt;!-- настраиваем Mocha --&gt;
&lt;script&gt; mocha.setup('bdd'); &lt;/script&gt;
        </code></pre>

        <pre class="fragment"><code class="hljs html size-XS" data-trim>
&lt;!-- подключаем файл с тестами --&gt;
&lt;script src="/form.test.js"&gt;&lt;/script&gt;
        </code></pre>

        <pre class="fragment"><code class="hljs html size-XS" data-trim>
&lt;!-- элемент в котором будут результаты тестов --&gt;
&lt;div id="mocha"&gt;&lt;/div&gt;
        </code></pre>

        <pre class="fragment"><code class="hljs html size-XS" data-trim>
&lt;!-- запускаем Mocha --&gt;
&lt;script&gt; mocha.run(); &lt;/script&gt;
        </code></pre>
    </section>

    <section>
        <h4><a href="http://localhost:63342/examples/twitter-signup/index.html" target="_blank">DEMO</a></h4>
    </section>
</section>

<section>
    <section>
        <h3>Автоматизировать?</h3>
    </section>

    <section>
        <h3><a href="http://phantomjs.org/" target="_blank">PhantomJS</a></h3>

        <blockquote cite="http://phantomjs.org/">
            PhantomJS is a headless WebKit scriptable with a JavaScript API.
        </blockquote>
    </section>

    <section>
        <h3><a href="https://github.com/nathanboktae/mocha-phantomjs" target="_blank">mocha-phantomjs</a></h3>

        <pre class="fragment"><code class="hljs size-S" data-trim>$ npm install -g mocha-phantomjs</code></pre>
    </section>

    <section>
        <h4>Адаптируем запуск</h4>

        <pre ><code class="hljs html size-XS" data-trim>
&lt;!-- запускаем Mocha --&gt;
&lt;script&gt;
    window.mochaPhantomJS ?
        mochaPhantomJS.run() :
        mocha.run();
&lt;/script&gt;
        </code></pre>
    </section>

    <section>
        <pre><code class="hljs size-XS" data-trim>$ mocha-phantomjs twitter-signup.html</code></pre>
        <br>
        <pre class="size-XS code fragment">
  Twitter signup
    <span style="color:green">✓</span> should alert when enter `twitterok`

  <span style="color:green">1 passing</span> (508ms)
    </section>

    <section>
        <h3><a href="https://karma-runner.github.io">Karma</a></h3>

        <p>Для запуска модульных тестов в реальном браузере</p>
    </section>
</section>

<section>

    <section data-background="images/test-cases.jpg" class='image'>
        <h3>Тестирование сценариев</h3>
    </section>

     <section>
        <ul>
            <li>Зайти на главную страницу twitter.com</li>
            <li>В строке поиска вбить #DumpConf</li>
            <li>Получить список твитов</li>
        </ul>
     </section>
</section>

<section>
    <section data-background="images/casperjs_header_pic.jpg" class='image'>
    </section>

    <section>
        <h3><a href="http://casperjs.org/" target="_blank">casperjs</a></h3>

        <pre class="fragment"><code class="hljs size-S" data-trim>$ npm install -g casperjs</code></pre>
    </section>

    <section>
        <pre><code class="hljs javascript size-S" data-trim>
casper.test.begin(
    'Search #DumpConf in twitter',
    function (test) { /* test */ }
);
        </code></pre>
    </section>

    <section>
        <pre><code class="hljs size-XS" data-trim>
casper
    .start('https://twitter.com/')
        </code></pre>
        <pre class="fragment"><code class="hljs size-XS">    .thenClick('.ItemSearch')</code></pre>
        <pre class="fragment"><code class="hljs size-XS">    .then(function () {
        this.fill('form#global-nav-search', {
            q: '#DumpConf'
        }, true);
    })</code></pre>
    </section>

    <section>
        <pre><code class="hljs size-XS">    .then(function () {
        test.assertUrlMatch(/\/search/,
            'should redirect to search page');
    })</code></pre>

        <pre class="fragment"><code class="hljs size-XS">    .then(function () {
        this.capture('twitter.png');
    })</code></pre>

        <pre class="fragment"><code class="hljs size-XS">    .run(function () {
        test.done();
    });</code></pre>
    </section>

    <section>
        <pre><code class="hljs size-XS" data-trim>$ casperjs test test/casper-test.js</code></pre>

        <img src="images/casper-test-report.jpg" alt="Casper test report" class="fragment"/>
    </section>

    <section>
        <h3><a href="http://webdriver.io/">Selenium</a></h3>

        <p>
            Для тестирования в настоящих браузерах
        </p>
    </section>
</section>


<section>
    <section data-background="images/repeat.jpg" class="image">
        <h3>Запускайте чаще</h3>
    </section>

    <section>
        <ul class="size-M">
            <li class="fragment">В IDE по хоткею</li>
            <li class="fragment">При сохранении файла</li>
            <li class="fragment">Перед коммитом и пушем</li>
            <li class="fragment">CI сервер</li>
        </ul>
    </section>

    <section>
        <h2><a href="https://travis-ci.org/">Travis</a></h2>
    </section>

    <section>
        <h3>package.json</h3>
            <pre><code class="hljs javascript size-XS" data-trim>
{
    "scripts": {
        "test": "mocha test"
    }
}
        </code></pre>
    </section>

    <section>
        <h3>.travis.yml</h3>

        <pre><code class="hljs javascript size-XS" data-trim>
language: node_js
node_js:
    - "4.1"
        </code></pre>
    </section>

    <section>
        <h3><a href="https://travis-ci.org/Zhigalov/frontend-fellows-test/builds" target="_blank">DEMO</a></h3>
    </section>

    <section>
        <h3>Информировать команду</h3>

        <ul>
            <li class="fragment"><img src="https://camo.githubusercontent.com/2a27dea777240ca4a7a5ea072363ef90b91b918b/68747470733a2f2f7472617669732d63692e6f72672f5a686967616c6f762f66726f6e74656e642d66656c6c6f77732d746573742e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/Zhigalov/frontend-fellows-test.svg?branch=master" style="max-width:100%;"></li>
            <li class="fragment">Письмо</li>
            <li class="fragment">SMS сообщение</li>
            <li class="fragment">Или как-то еще... ;)</li>
        </ul>
    </section>
</section>

<section>
    <section data-background="images/first-step.png" class="image">
        <h3>Первый шаг</h3>
    </section>

    <section>
        <ul class="size-M">
            <li class="fragment">Хелпер</li>
            <li class="fragment">Базовая модель</li>
            <li class="fragment">Независимый модуль</li>
        </ul>
    </section>
</section>

<section  data-background="images/medical-plaster.jpg" class='image'>
    <h3>Пишите тесты сразу</h3>
</section>


<section>
    <section>
        <h4>Приемы тестирования можно использовать и без тестов</h4>
    </section>

    <section>
        <h3><a href="https://github.com/pgte/nock" target="_blank">nock</a></h3>

        <pre><code class="hljs javascript size-XS" data-trim>
var nock = require('nock');

nock('https://translate.yandex.net')
    .get('/api/v1.5/tr.json/translate')
    .query(true)
    .reply(200, {text: ['Hello, world!']});
        </code></pre>
    </section>
</section>

<section>
    <h3>Спасибо!</h3>

    <ul class="size-S">
        <li><a href="https://mochajs.org/">mochajs.org</a></li>
        <li><a href="http://chaijs.com/">chaijs.com</a></li>
        <li><a href="https://github.com/mfncooper/mockery">github.com/mfncooper/mockery</a></li>
        <li><a href="http://sinonjs.org/">sinonjs.org</a></li>
        <li><a href="https://github.com/pgte/nock">github.com/pgte/nock</a></li>
        <li><a href="https://travis-ci.org/">travis-ci.org</a></li>
    </ul>

    <p>
        @sergey_zhigalov
    </p>
</section>
</div>

</div>

	<script src="lib/js/head.min.js"></script>
	<script src="js/reveal.js"></script>

	<script>

		// Full list of configuration options available at:
		// https://github.com/hakimel/reveal.js#configuration
		Reveal.initialize({
			controls: false,
			progress: true,
            slideNumber: true,
			center: true,
			transition: 'slide',
            history: true,
            dependencies: [
				{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
				{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
				{ src: 'plugin/zoom-js/zoom.js', async: true },
				{ src: 'plugin/notes/notes.js', async: true }
			]
		});

	</script>

</body>
</html>
